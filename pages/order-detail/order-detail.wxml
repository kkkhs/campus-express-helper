<view class="container">
  <view wx:if="{{!order}}" class="loading">
    <text class="loading-icon">â³</text>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
  
  <view wx:else class="content">
    <!-- é¡¶éƒ¨çŠ¶æ€å¡ç‰‡ -->
    <view class="header-card">
      <view class="header-bg"></view>
      <view class="header-content">
        <view class="status-row">
          <view class="status-badge status-{{order.status}}">
            <text class="status-icon">{{order.statusIcon}}</text>
            <text class="status-text">{{order.statusText}}</text>
          </view>
        </view>
        <view class="reward-display">
          <text class="reward-label">ä»»åŠ¡é…¬åŠ³</text>
          <view class="reward-amount">
            <text class="reward-symbol">Â¥</text>
            <text class="reward-value">{{task && task.reward || 0}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ä»»åŠ¡ä¿¡æ¯å¡ç‰‡ -->
    <view wx:if="{{task}}" class="info-card">
      <view class="card-header">
        <text class="card-icon">ğŸ“¦</text>
        <text class="card-title">ä»»åŠ¡ä¿¡æ¯</text>
      </view>
      <view class="card-body">
        <view class="info-row">
          <view class="info-icon-wrapper green">
            <text class="info-icon">ğŸ“</text>
          </view>
          <view class="info-content">
            <text class="info-label">å¿«é€’ç‚¹</text>
            <text class="info-value">{{task.pickupPoint}}</text>
          </view>
        </view>
        <view class="info-row">
          <view class="info-icon-wrapper blue">
            <text class="info-icon">ğŸ“¦</text>
          </view>
          <view class="info-content">
            <text class="info-label">å¿«é€’å…¬å¸</text>
            <text class="info-value">{{task.company}}</text>
          </view>
        </view>
        <view class="info-row">
          <view class="info-icon-wrapper orange">
            <text class="info-icon">ğŸ”¢</text>
          </view>
          <view class="info-content">
            <text class="info-label">å–ä»¶ç </text>
            <text class="info-value highlight">{{task.pickupCode}}</text>
          </view>
        </view>
        <view wx:if="{{task.remark}}" class="remark-box">
          <text class="remark-icon">ğŸ’­</text>
          <text class="remark-text">{{task.remark}}</text>
        </view>
      </view>
    </view>

    <!-- æ—¶é—´ä¿¡æ¯å¡ç‰‡ -->
    <view class="info-card">
      <view class="card-header">
        <text class="card-icon">â°</text>
        <text class="card-title">æ—¶é—´ä¿¡æ¯</text>
      </view>
      <view class="card-body">
        <view class="time-row">
          <text class="time-label">åˆ›å»ºæ—¶é—´</text>
          <text class="time-value">{{order.createTimeText}}</text>
        </view>
        <view wx:if="{{order.completeTime}}" class="time-row">
          <text class="time-label">å®Œæˆæ—¶é—´</text>
          <text class="time-value">{{order.completeTimeText}}</text>
        </view>
      </view>
    </view>

    <!-- å‘å¸ƒè€…ä¿¡æ¯å¡ç‰‡ -->
    <view wx:if="{{publisher}}" class="info-card">
      <view class="card-header">
        <text class="card-icon">ğŸ‘¤</text>
        <text class="card-title">å‘å¸ƒè€…ä¿¡æ¯</text>
      </view>
      <view class="card-body">
        <view class="user-profile">
          <image class="user-avatar" src="{{publisher.avatar || '/images/default-avatar.png'}}" mode="aspectFill" />
          <view class="user-info">
            <text class="user-name">{{publisher.nickname}}</text>
            <view class="user-rating">
              <text class="rating-star">â­</text>
              <text class="rating-score">{{publisher.rating}}</text>
            </view>
          </view>
        </view>
        <view class="contact-section">
          <view wx:if="{{publisher.phone}}" class="contact-btn" bindtap="makePhoneCall" data-phone="{{publisher.phone}}">
            <text class="contact-btn-icon">ğŸ“</text>
            <text class="contact-btn-text">æ‹¨æ‰“ç”µè¯</text>
            <text class="contact-btn-value">{{publisher.phone}}</text>
          </view>
          <view wx:if="{{publisher.wechat}}" class="contact-btn" bindtap="copyWechat" data-wechat="{{publisher.wechat}}">
            <text class="contact-btn-icon">ğŸ’¬</text>
            <text class="contact-btn-text">å¤åˆ¶å¾®ä¿¡</text>
            <text class="contact-btn-value">{{publisher.wechat}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ¥å•è€…ä¿¡æ¯å¡ç‰‡ -->
    <view wx:if="{{taker}}" class="info-card">
      <view class="card-header">
        <text class="card-icon">ğŸ¤</text>
        <text class="card-title">æ¥å•è€…ä¿¡æ¯</text>
      </view>
      <view class="card-body">
        <view class="user-profile">
          <image class="user-avatar" src="{{taker.avatar || '/images/default-avatar.png'}}" mode="aspectFill" />
          <view class="user-info">
            <text class="user-name">{{taker.nickname}}</text>
            <view class="user-rating">
              <text class="rating-star">â­</text>
              <text class="rating-score">{{taker.rating}}</text>
            </view>
          </view>
        </view>
        <view class="contact-section">
          <view wx:if="{{taker.phone}}" class="contact-btn" bindtap="makePhoneCall" data-phone="{{taker.phone}}">
            <text class="contact-btn-icon">ğŸ“</text>
            <text class="contact-btn-text">æ‹¨æ‰“ç”µè¯</text>
            <text class="contact-btn-value">{{taker.phone}}</text>
          </view>
          <view wx:if="{{taker.wechat}}" class="contact-btn" bindtap="copyWechat" data-wechat="{{taker.wechat}}">
            <text class="contact-btn-icon">ğŸ’¬</text>
            <text class="contact-btn-text">å¤åˆ¶å¾®ä¿¡</text>
            <text class="contact-btn-value">{{taker.wechat}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
