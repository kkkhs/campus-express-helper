<view class="container">
  <!-- çŠ¶æ€æ ‡ç­¾æ  -->
  <view class="status-tabs">
    <view 
      wx:for="{{statusTabs}}" 
      wx:key="key"
      class="tab-item {{activeTab === item.key ? 'active' : ''}}"
      bindtap="onTabChange"
      data-tab="{{item.key}}"
    >
      <text class="tab-text">{{item.name}}</text>
    </view>
  </view>

  <!-- ä»»åŠ¡åˆ—è¡¨ -->
  <scroll-view scroll-y class="task-list" refresher-enabled refresher-triggered="{{loading}}" bindrefresherrefresh="onPullDownRefresh">
    <view wx:if="{{tasks.length === 0 && !loading}}" class="empty-state">
      <text class="empty-icon">ğŸ“‹</text>
      <text class="empty-text">æš‚æ— ç›¸å…³ä»»åŠ¡</text>
    </view>

    <view wx:for="{{tasks}}" wx:key="_id" class="task-item">
      <view class="task-header">
        <view class="task-info">
          <text class="task-time">{{formatTime(item.createTime)}}</text>
          <view class="status-badge" style="color: {{getStatusStyle(item.status).color}}; background: {{getStatusStyle(item.status).bg}};">
            {{getStatusStyle(item.status).text}}
          </view>
        </view>
        <view class="reward">Â¥{{item.reward}}</view>
      </view>

      <view class="task-content" bindtap="viewTaskDetail" data-task-id="{{item._id}}">
        <view class="pickup-info">
          <text class="pickup-point">{{item.pickupPoint === 'south' ? 'å—åŒº' : 'åŒ—åŒº'}}</text>
          <text class="company">{{item.company}}</text>
        </view>
        <view class="pickup-code">å–ä»¶ç ï¼š{{item.pickupCode}}</view>
        <view class="contact-info">
          <text class="phone">ğŸ“ {{item.phone}}</text>
          <text class="wechat" wx:if="{{item.wechat}}">ğŸ’¬ {{item.wechat}}</text>
        </view>
        <view class="remark" wx:if="{{item.remark}}">å¤‡æ³¨ï¼š{{item.remark}}</view>
      </view>

      <view class="task-actions">
        <button 
          wx:if="{{item.status === 'pending'}}" 
          class="btn-cancel"
          bindtap="cancelTask"
          data-task-id="{{item._id}}"
        >
          å–æ¶ˆä»»åŠ¡
        </button>
        <button 
          wx:if="{{item.status === 'accepted'}}" 
          class="btn-complete"
          bindtap="completeTask"
          data-task-id="{{item._id}}"
        >
          å®Œæˆä»»åŠ¡
        </button>
        <button 
          wx:if="{{item.status === 'completed' && !item.reviewed}}" 
          class="btn-review"
          bindtap="goToReview"
          data-task-id="{{item._id}}"
          data-order-id="{{item.orderId}}"
        >
          è¯„ä»·æ¥å•è€…
        </button>
        <button 
          wx:if="{{item.status === 'completed' && item.reviewed}}" 
          class="btn-reviewed"
          disabled
        >
          å·²è¯„ä»·
        </button>
      </view>
    </view>

    <view wx:if="{{loading && tasks.length > 0}}" class="loading-more">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>

    <view wx:if="{{!hasMore && tasks.length > 0}}" class="no-more">
      <text class="no-more-text">æ²¡æœ‰æ›´å¤šä»»åŠ¡äº†</text>
    </view>
  </scroll-view>
</view>