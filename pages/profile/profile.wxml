<view class="container">
  <!-- 用户信息卡片 -->
  <view class="user-header">
    <view class="header-bg"></view>
    <view class="user-info">
      <view class="avatar-wrapper" bindtap="editAvatar">
        <image class="avatar" src="{{userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill" />
        <view class="avatar-edit-hint">
          <text class="edit-icon">📷</text>
        </view>
      </view>
      <view class="user-details">
        <text class="nickname">{{userInfo.nickname || '匿名用户'}}</text>
        <view class="rating-row">
          <text class="rating-star">⭐</text>
          <text class="rating-score">{{userInfo.rating || '5.0'}}</text>
          <text class="rating-label">信用分</text>
        </view>
      </view>
    </view>
    
    <!-- 快捷操作按钮 -->
    <view class="quick-actions">
      <button class="action-btn" bindtap="editAvatar">
        <text class="action-icon">📷</text>
        <text class="action-text">修改头像</text>
      </button>
      <button class="action-btn" bindtap="editProfile">
        <text class="action-icon">✏️</text>
        <text class="action-text">编辑资料</text>
      </button>
    </view>
  </view>

  <!-- 数据统计卡片 -->
  <view class="stats-section">
    <view class="stats-card">
      <view class="stat-item">
        <text class="stat-value">{{stats.publishCount || 0}}</text>
        <text class="stat-label">发布任务</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-value">{{stats.acceptCount || 0}}</text>
        <text class="stat-label">接单次数</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-value">{{stats.completeCount || 0}}</text>
        <text class="stat-label">完成订单</text>
      </view>
    </view>
  </view>

  <!-- 联系方式卡片 -->
  <view class="contact-section">
    <view class="section-title">
      <text class="title-icon">📱</text>
      <text class="title-text">联系方式</text>
    </view>
    <view class="contact-card">
      <view class="contact-item" bindtap="editProfile">
        <view class="contact-left">
          <text class="contact-icon">📞</text>
          <text class="contact-label">手机号码</text>
        </view>
        <view class="contact-right">
          <text class="contact-value">{{userInfo.phone || '未设置'}}</text>
          <text class="contact-arrow">›</text>
        </view>
      </view>
      <view class="contact-item" bindtap="editProfile">
        <view class="contact-left">
          <text class="contact-icon">💬</text>
          <text class="contact-label">微信号</text>
        </view>
        <view class="contact-right">
          <text class="contact-value">{{userInfo.wechat || '未设置'}}</text>
          <text class="contact-arrow">›</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="menu-section">
    <view class="section-title">
      <text class="title-icon">🛠️</text>
      <text class="title-text">功能菜单</text>
    </view>
    <view class="menu-card">
      <view class="menu-item" bindtap="goToMyTasks">
        <view class="menu-left">
          <view class="menu-icon-wrapper blue">
            <text class="menu-icon">📋</text>
          </view>
          <text class="menu-text">我的发布</text>
        </view>
        <text class="menu-arrow">›</text>
      </view>
      
      <view class="menu-item" bindtap="goToMyOrders">
        <view class="menu-left">
          <view class="menu-icon-wrapper green">
            <text class="menu-icon">🤝</text>
          </view>
          <text class="menu-text">我的接单</text>
        </view>
        <text class="menu-arrow">›</text>
      </view>
      
      <view class="menu-item" bindtap="goToMyReviews">
        <view class="menu-left">
          <view class="menu-icon-wrapper orange">
            <text class="menu-icon">⭐</text>
          </view>
          <text class="menu-text">我的评价</text>
        </view>
        <text class="menu-arrow">›</text>
      </view>
      
      <view class="menu-item" bindtap="goToAbout">
        <view class="menu-left">
          <view class="menu-icon-wrapper purple">
            <text class="menu-icon">ℹ️</text>
          </view>
          <text class="menu-text">关于我们</text>
        </view>
        <text class="menu-arrow">›</text>
      </view>
      
      <!-- 管理员功能 -->
      <view wx:if="{{isAdmin}}" class="menu-item admin-item" bindtap="goToAdmin">
        <view class="menu-left">
          <view class="menu-icon-wrapper red">
            <text class="menu-icon">🔧</text>
          </view>
          <text class="menu-text">后台管理</text>
          <text class="admin-badge">管理员</text>
        </view>
        <text class="menu-arrow">›</text>
      </view>
    </view>
  </view>

  <!-- 退出登录 -->
  <view class="logout-section">
    <button class="btn-logout" bindtap="logout">
      <text class="logout-icon">🚪</text>
      <text>退出登录</text>
    </button>
  </view>

  <!-- 编辑资料弹窗 -->
  <view class="modal-overlay {{showEditModal ? 'show' : ''}}" bindtap="closeEditModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">编辑资料</text>
        <text class="modal-close" bindtap="closeEditModal">✕</text>
      </view>
      
      <form bindsubmit="onEditSubmit">
        <view class="edit-form">
          <view class="form-group">
            <text class="form-label">昵称</text>
            <input 
              class="form-input" 
              name="nickname" 
              type="nickname"
              value="{{editForm.nickname}}"
              placeholder="请输入昵称"
              maxlength="20"
            />
            <text class="form-hint">💡 使用type="nickname"可以快速填充微信昵称</text>
          </view>
          
          <view class="form-group">
            <text class="form-label">联系电话</text>
            <input 
              class="form-input" 
              name="phone" 
              type="number"
              value="{{editForm.phone}}"
              placeholder="请输入联系电话"
              maxlength="11"
            />
          </view>
          
          <view class="form-group">
            <text class="form-label">微信号</text>
            <input 
              class="form-input" 
              name="wechat" 
              value="{{editForm.wechat}}"
              placeholder="请输入微信号"
              maxlength="30"
            />
          </view>
        </view>
        
        <view class="modal-buttons">
          <button class="btn-cancel" bindtap="closeEditModal">取消</button>
          <button class="btn-confirm" form-type="submit">保存</button>
        </view>
      </form>
    </view>
  </view>

  <!-- 头像编辑弹窗 -->
  <view class="modal-overlay {{showAvatarModal ? 'show' : ''}}" bindtap="closeAvatarModal">
    <view class="modal-content avatar-modal" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">修改头像</text>
        <text class="modal-close" bindtap="closeAvatarModal">✕</text>
      </view>
      
      <view class="avatar-edit-content">
        <view class="avatar-preview">
          <image class="preview-img" src="{{tempAvatarUrl || userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill" />
        </view>
        
        <button class="btn-choose-avatar" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
          <text class="btn-icon">📷</text>
          <text>选择新头像</text>
        </button>
        
        <text class="avatar-hint">💡 点击按钮选择相册中的图片作为头像</text>
      </view>
      
      <view class="modal-buttons">
        <button class="btn-cancel" bindtap="closeAvatarModal">取消</button>
        <button class="btn-confirm" bindtap="saveAvatar">保存</button>
      </view>
    </view>
  </view>
</view>
